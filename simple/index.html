<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub page as PWA template</title>
  <link rel="canonical" href="https://jackson-cmd.github.io/simple/" />
  <link rel="manifest" href="/simple/manifest.json">
</head>

<body>
  <button id="find-me">Show my location</button><br />
  <p id="status"></p>
  <a id="map-link" target="_blank"></a>

  <br>
  <button id="showNotificationBtn">Show Notification</button>
  …
  <p><button id="btnStart">START RECORDING</button><br />
    <button id="btnStop">STOP RECORDING</button>
  </p>
  <h1>Microphone and Camera Permissions</h1>

  <button id="requestMicrophoneBtn">Request Microphone Permission</button>
  <button id="requestCameraBtn">Request Camera Permission</button>
  <p id="microphonePermissionStatus">Microphone Permission: Not requested</p>
  <p id="cameraPermissionStatus">Camera Permission: Not requested</p>
  <video controls></video>

  <video id="vid2" controls></video>
  <script>
    if (navigator.serviceWorker) {
      navigator.serviceWorker.register(
        '/simple/sw.js',
        { scope: '/simple/' }
      )
    }
    // Check if the browser supports the Notification API
    if ("Notification" in window) {
      // Check if notifications are allowed
      if (Notification.permission === "granted") {
        // If permission is already granted, you can show a notification
        showNotification();
      } else if (Notification.permission !== "denied") {
        // If permission is not denied, request permission
        document.getElementById("showNotificationBtn").addEventListener("click", function () {
          Notification.requestPermission().then(function (permission) {
            if (permission === "granted") {
              showNotification();
            }
          });
        });
      }
    }

    function showNotification() {
      // Create and display a notification
      const notification = new Notification("Hello, World!", {
        body: "This is a notification example.",
        icon: "https://via.placeholder.com/48", // Replace with your own icon URL
      });

      // Handle click on the notification
      notification.addEventListener("click", function () {
        alert("Notification clicked!");
      });
    }

    // get geolocation
    function geoFindMe() {
      const status = document.querySelector("#status");
      const mapLink = document.querySelector("#map-link");

      mapLink.href = "";
      mapLink.textContent = "";

      function success(position) {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;

        status.textContent = "";
        mapLink.href = `https://www.openstreetmap.org/#map=18/${latitude}/${longitude}`;
        mapLink.textContent = `Latitude: ${latitude} °, Longitude: ${longitude} °`;
      }

      function error() {
        status.textContent = "Unable to retrieve your location";
      }

      if (!navigator.geolocation) {
        status.textContent = "Geolocation is not supported by your browser";
      } else {
        status.textContent = "Locating…";
        navigator.geolocation.getCurrentPosition(success, error);
      }
    }

    document.querySelector("#find-me").addEventListener("click", geoFindMe);

    // get media
    const requestMicrophoneBtn = document.getElementById("requestMicrophoneBtn");
    const requestCameraBtn = document.getElementById("requestCameraBtn");
    const microphonePermissionStatus = document.getElementById("microphonePermissionStatus");
    const cameraPermissionStatus = document.getElementById("cameraPermissionStatus");

    requestMicrophoneBtn.addEventListener("click", async () => {
      try {
        // Request microphone permission
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });

        // Microphone permission is granted
        microphonePermissionStatus.textContent = "Microphone Permission: Allowed";

        // Stop the stream (optional)
        stream.getTracks().forEach(track => track.stop());
      } catch (error) {
        // Microphone permission is denied
        microphonePermissionStatus.textContent = "Microphone Permission: Denied";
      }
    });

    requestCameraBtn.addEventListener("click", async () => {
      try {
        // Request camera permission
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });

        // Camera permission is granted
        cameraPermissionStatus.textContent = "Camera Permission: Allowed";

        // Stop the stream (optional)
        stream.getTracks().forEach(track => track.stop());
      } catch (error) {
        // Camera permission is denied
        cameraPermissionStatus.textContent = "Camera Permission: Denied";
      }
    });

  </script>
</body>

</html>