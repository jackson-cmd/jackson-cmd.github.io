<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Starbucks</title>
  <link rel="canonical" href="https://jackson-cmd.github.io/simple/" />
  <link rel="manifest" href="/simple/manifest.json">
</head>

<body>
  <h1> Geolocation Permission</h1>
  <button id="find-me">Show my location</button><br />
  <p id="status"></p>
  <a id="map-link" target="_blank"></a>

  <h1>Notification Permission</h1>

  <button id="requestNotificationBtn">Request Notification Permission</button>
  <p id="notificationPermissionStatus">Notification Permission: Not requested</p>

  <h1>Microphone and Camera Permissions</h1>

  <button id="requestMicrophoneBtn">Request Microphone Permission</button>
  <button id="requestCameraBtn">Request Camera Permission</button>
  <p id="microphonePermissionStatus">Microphone Permission: Not requested</p>
  <p id="cameraPermissionStatus">Camera Permission: Not requested</p>
  <h1>Clipboard Read and Write</h1>

  <button id="copyBtn">Copy Text to Clipboard</button>
  <button id="pasteBtn">Paste Text from Clipboard</button>
  <textarea id="clipboardText" rows="4" cols="50">Text to copy and paste.</textarea>
  <p id="clipboardPermissionStatus">Clipboard Permission: Not requested</p>

  <script>
    if (navigator.serviceWorker) {
      navigator.serviceWorker.register(
        '/simple/sw.js',
        { scope: '/simple/' }
      )
    }
    const requestNotificationBtn = document.getElementById("requestNotificationBtn");
    const notificationPermissionStatus = document.getElementById("notificationPermissionStatus");

    requestNotificationBtn.addEventListener("click", async () => {
      try {
        // Request notification permission
        const permission = await Notification.requestPermission();

        // Check the permission status
        if (permission === "granted") {
          // Notification permission is allowed
          notificationPermissionStatus.textContent = "Notification Permission: Allowed";
        } else if (permission === "denied") {
          // Notification permission is denied
          notificationPermissionStatus.textContent = "Notification Permission: Denied";
        } else if (permission === "default") {
          // Notification permission is not yet requested or the user dismissed the request
          notificationPermissionStatus.textContent = "Notification Permission: Not requested";
        }
      } catch (error) {
        // Handle any errors
        console.error("Error requesting notification permission:", error);
      }
    });

    // get geolocation
    function geoFindMe() {
      const status = document.querySelector("#status");
      const mapLink = document.querySelector("#map-link");

      mapLink.href = "";
      mapLink.textContent = "";

      function success(position) {
        const latitude = position.coords.latitude;
        const longitude = position.coords.longitude;

        status.textContent = "";
        mapLink.href = `https://www.openstreetmap.org/#map=18/${latitude}/${longitude}`;
        mapLink.textContent = `Latitude: ${latitude} °, Longitude: ${longitude} °`;
      }

      function error() {
        status.textContent = "Unable to retrieve your location";
      }

      if (!navigator.geolocation) {
        status.textContent = "Geolocation is not supported by your browser";
      } else {
        status.textContent = "Locating…";
        navigator.geolocation.getCurrentPosition(success, error);
      }
    }

    document.querySelector("#find-me").addEventListener("click", geoFindMe);

    // get media
    const requestMicrophoneBtn = document.getElementById("requestMicrophoneBtn");
    const requestCameraBtn = document.getElementById("requestCameraBtn");
    const microphonePermissionStatus = document.getElementById("microphonePermissionStatus");
    const cameraPermissionStatus = document.getElementById("cameraPermissionStatus");

    requestMicrophoneBtn.addEventListener("click", async () => {
      try {
        // Request microphone permission
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });

        // Microphone permission is granted
        microphonePermissionStatus.textContent = "Microphone Permission: Allowed";

        // Stop the stream (optional)
        stream.getTracks().forEach(track => track.stop());
      } catch (error) {
        // Microphone permission is denied
        microphonePermissionStatus.textContent = "Microphone Permission: Denied";
      }
    });

    requestCameraBtn.addEventListener("click", async () => {
      try {
        // Request camera permission
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });

        // Camera permission is granted
        cameraPermissionStatus.textContent = "Camera Permission: Allowed";

        // Stop the stream (optional)
        stream.getTracks().forEach(track => track.stop());
      } catch (error) {
        // Camera permission is denied
        cameraPermissionStatus.textContent = "Camera Permission: Denied";
      }
    });


    //clipboard
    const copyBtn = document.getElementById("copyBtn");
    const pasteBtn = document.getElementById("pasteBtn");
    const clipboardText = document.getElementById("clipboardText");
    const clipboardPermissionStatus = document.getElementById("clipboardPermissionStatus");

    // Check clipboard permission
    const checkClipboardPermission = async () => {
      try {
        const permissionState = await navigator.permissions.query({ name: 'clipboard-read' });
        clipboardPermissionStatus.textContent = `Clipboard Permission: ${permissionState.state}`;
      } catch (error) {
        console.error("Error checking clipboard permission:", error);
      }
    };

    // Copy text to clipboard
    copyBtn.addEventListener("click", async () => {
      const textToCopy = clipboardText.value;

      try {
        // Use the Clipboard API to write text to the clipboard
        await navigator.clipboard.writeText(textToCopy);
        console.log("Text copied to clipboard: " + textToCopy);
      } catch (error) {
        console.error("Error copying to clipboard:", error);
      }
    });

    // Paste text from clipboard
    pasteBtn.addEventListener("click", async () => {
      try {
        // Use the Clipboard API to read text from the clipboard
        const clipboardData = await navigator.clipboard.readText();
        clipboardText.value = clipboardData;
        console.log("Text pasted from clipboard: " + clipboardData);
      } catch (error) {
        console.error("Error pasting from clipboard:", error);
      }
    });

    // Check clipboard permission on page load
    checkClipboardPermission();
  </script>
</body>

</html>